# 🚀 部署架构

## 部署环境设计

```mermaid
graph TB
    subgraph "用户环境"
        USER_MACHINE[用户本地机器<br/>macOS/Linux/Windows]
        
        subgraph "AI Agent 平台"
            GEMINI_CLI[Gemini CLI]
            CLAUDE_CODE[Claude Code]
            OTHER_AI_PLATFORM[其他AI平台]
        end
        
        subgraph "PersonalManager 工具集"
            PM_CORE_FUNCTIONS[PersonalManager 核心功能<br/>(Python 函数)]
            PM_TOOL_DEFINITIONS[工具定义文件<br/>(JSON/YAML)]
            PM_DATA_STORE[本地数据存储<br/>(~/.personalmanager/)]
        end
        
        subgraph "外部服务"
            GOOGLE_SERVICES[Google Workspace APIs]
            GITHUB_GITLAB[GitHub/GitLab]
            CLOUD_BACKUP[云端备份 (可选)]
            EXTERNAL_LLM[外部大语言模型<br/>(Gemini API/Claude API)]
        end
    end
    
    USER_MACHINE --> AI_AGENT_PLATFORM
    AI_AGENT_PLATFORM --> PM_TOOL_COLLECTION
    PM_TOOL_COLLECTION --> PM_DATA_STORE
    PM_TOOL_COLLECTION --> EXTERNAL_LLM
    PM_TOOL_COLLECTION --> GOOGLE_SERVICES
    PM_TOOL_COLLECTION --> GITHUB_GITLAB
    PM_DATA_STORE --> CLOUD_BACKUP
```

## 安装和配置流程

### 1. 系统要求

```yaml
system_requirements:
  operating_systems:
    - macOS: "10.15 or later"
    - Linux: "Ubuntu 18.04+, CentOS 7+"
    - Windows: "Windows 10 or later"
    
  runtime_dependencies:
    - Python: ">=3.9" # PersonalManager核心功能运行环境
    - Git: ">=2.20"
    - AI_PLATFORM_SDK: "根据所选AI平台要求" # 例如 Google Generative AI SDK, Anthropic SDK
    
  optional_dependencies:
    - Obsidian: ">=0.15" (for知识管理)
    
  hardware_requirements:
    - RAM: "4GB minimum, 8GB recommended"
    - Storage: "1GB for installation, 5GB for data"
    - Network: "Internet connection for API integrations"
```

### 2. 安装流程 (AI工具集模式)

```yaml
installation_process:
  step_1_prerequisites:
    - 确保Python环境和Git已安装
    - 根据所选AI平台安装对应的SDK
    - 获取并配置AI服务API密钥 (例如 ~/.personalmanager/credentials.json)
    
  step_2_core_installation:
    - 克隆PersonalManager代码库
    - 安装Python依赖 (poetry install)
    
  step_3_tool_registration:
    - **将PersonalManager的核心功能注册为AI平台的工具**
    - 具体步骤取决于AI平台：
      - **Gemini CLI**: 通过Python SDK将函数暴露为工具
      - **Claude Code**: 通过特定接口或插件机制注册
      - **其他平台**: 遵循其工具集成指南
    
  step_4_configuration:
    - 运行 `pm setup` (或等效的AI工具调用) 进行首次配置
    - 配置项目文件夹路径
    - 选择启用的书籍理论模块
    
  step_5_verification:
    - 通过AI平台调用PersonalManager工具进行测试 (例如，对AI说“捕获一个任务：测试任务”)
    - 验证数据持久化和外部集成功能
```

### 3. 配置管理

```yaml
configuration_management:
  config_hierarchy:
    1_system_defaults: built_in_defaults
    2_user_global: ~/.personalmanager/config.yaml
    3_project_local: .pm-config.yaml # 项目级配置，用于报告生成等
    4_environment_variables: PM_* prefixed variables
    
  configuration_categories:
    core_settings:
      - data_storage_path
      - log_level
      - ai_tool_provider: "默认AI服务提供商 (claude/gemini)"
      
    integration_settings:
      - google_api_credentials_path: "~/.personalmanager/credentials.json"
      - google_tasks_list_id: "默认Google Tasks列表ID"
      - ai_service_api_keys: "通过环境变量或config.yaml安全管理"
      
    user_preferences:
      - work_hours
      - energy_patterns
      - enabled_book_modules: "启用的书籍理论模块"
      
    advanced_settings:
      - custom_agent_configs
      - workflow_templates
      - automation_rules
```

---
