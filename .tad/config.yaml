# TAD Configuration v1.3 - Evidence-Based Development
method: TAD
version: 1.3.0
description: Triangle Agent Development - è¯æ®å¼å¼€å‘ç³»ç»Ÿ
last_updated: 2025-11-25

# ==================== æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ ====================
document_management:
  manifest_file: .tad/manifest.yaml
  naming_convention:
    format: "{timestamp}_{version}_{task_id}_{type}_{status}.md"
    example: "20250128_1430_v1.2_TASK001_design_draft.md"

  structure:
    active:           # å½“å‰æ´»è·ƒä»»åŠ¡
      - tasks         # ä»»åŠ¡è¿½è¸ª
      - designs       # è®¾è®¡æ–‡æ¡£
      - handoffs      # äº¤æ¥æ–‡æ¡£
    archive:          # å·²å®Œæˆå½’æ¡£
      - by_date       # æŒ‰æ—¥æœŸ
      - by_task       # æŒ‰ä»»åŠ¡
      - by_version    # æŒ‰ç‰ˆæœ¬
    context: "é¡¹ç›®é•¿æœŸä¿¡æ¯"
    working: "å·¥ä½œä¸­æ–‡æ¡£"

  version_control:
    enabled: true
    auto_increment: true
    hash_verification: true
    change_tracking: true

  mandatory_sections:
    header:
      - task_id: "TASK-{YYYY}{MM}{DD}-{seq}"
      - version: "v{major}.{minor}.{patch}"
      - status: "draft|review|approved|implemented|archived"
      - owner: "{agent_name}"
      - created: "{timestamp}"
      - modified: "{timestamp}"
      - previous_version: "{link_to_previous}"

    metadata:
      - hash: "{file_hash}"
      - modified_by: "{agent_name}"
      - change_summary: "{summary}"

# ==================== Agent æ¿€æ´»åè®® ====================
activation_protocol:
  # å¼ºåˆ¶4æ­¥æ¿€æ´»æµç¨‹ï¼ˆå€Ÿé‰´BMADï¼‰
  mandatory_steps:
    step1:
      name: "èº«ä»½åŠ è½½"
      action: "è¯»å–å®Œæ•´agentå®šä¹‰æ–‡ä»¶"
      verification: "ç¡®è®¤æ–‡ä»¶hashåŒ¹é…"

    step2:
      name: "èº«ä»½ç¡®è®¤"
      action: "é‡‡ç”¨å®šä¹‰çš„persona"
      output: "æˆ‘æ˜¯{agent_name}ï¼Œ{role}"

    step3:
      name: "é…ç½®åŠ è½½"
      action: "åŠ è½½.tad/config-v3.yaml"
      verification: "æ˜¾ç¤ºåŠ è½½çš„é…ç½®ç‰ˆæœ¬"

    step4:
      name: "èƒ½åŠ›å±•ç¤º"
      action: "è‡ªåŠ¨è¿è¡Œ*helpå‘½ä»¤"
      output: "æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤å’Œèƒ½åŠ›"

  violation_detection:
    - "è·³è¿‡ä»»ä½•æ­¥éª¤ â†’ è­¦å‘Šå¹¶é‡æ–°æ¿€æ´»"
    - "èº«ä»½æ··æ·† â†’ ç«‹å³çº æ­£"
    - "æœªæ˜¾ç¤ºhelp â†’ è‡ªåŠ¨è¡¥å……"

# ==================== æ ¸å¿ƒä¸‰è§’æ¨¡å‹ï¼ˆå¢å¼ºç‰ˆï¼‰ ====================
triangle:
  human:
    role: Value Guardian
    responsibilities:
      - å®šä¹‰ä»·å€¼å’Œéœ€æ±‚
      - éªŒè¯äº¤ä»˜ä»·å€¼
      - åšå…³é”®å†³ç­–
    commands:
      - "*status": æŸ¥çœ‹å½“å‰çŠ¶æ€
      - "*task": æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨
      - "*approve": æ‰¹å‡†è®¾è®¡/å®æ–½

  agent_a:
    name: Alex
    role: Solution Lead
    terminal: 1

    # æ–°å¢ï¼šå¼ºåˆ¶èŒè´£
    mandatory_responsibilities:
      - æ·±åº¦éœ€æ±‚æŒ–æ˜ï¼ˆä¸å°‘äº3è½®ç¡®è®¤ï¼‰
      - è®¾è®¡æ–¹æ¡ˆï¼ˆå¿…é¡»è°ƒç”¨ç›¸å…³sub-agentsï¼‰
      - åˆ›å»ºhandoffæ–‡æ¡£
      - è´¨é‡å®¡æŸ¥ï¼ˆä¸èƒ½è·³è¿‡ï¼‰

    # æ–°å¢ï¼šç¦æ­¢è¡Œä¸ºï¼ˆå…³é”®ï¼ï¼‰
    forbidden_actions:
      - "ç›´æ¥ç¼–å†™å®ç°ä»£ç "
      - "æ‰§è¡Œæµ‹è¯•è„šæœ¬"
      - "éƒ¨ç½²æˆ–è¿è¡Œåº”ç”¨"
      - "ä¿®æ”¹Agent Bçš„ä»£ç "
      - "è·³è¿‡éœ€æ±‚ç¡®è®¤"

    # æ–°å¢ï¼šå¼ºåˆ¶äº¤æ¥è§¦å‘è¯
    handoff_triggers:
      keywords: ["å®ç°", "æ‰§è¡Œ", "ç¼–ç ", "éƒ¨ç½²", "æµ‹è¯•è¿è¡Œ"]
      action: |
        æ£€æµ‹åˆ°æ‰§è¡Œç±»å…³é”®è¯ï¼
        ç«‹å³åœæ­¢ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
        1. å®Œæˆå½“å‰è®¾è®¡æ–‡æ¡£
        2. åˆ›å»ºhandoffæ–‡æ¡£
        3. ç”ŸæˆAgent Bçš„æ‰§è¡Œprompt
        4. æç¤ºç”¨æˆ·è½¬äº¤ç»™Blake

    # æ–°å¢ï¼šå‘½ä»¤ç³»ç»Ÿ
    commands:
      - "*plan <requirement>": "åˆ›å»ºsprintè®¡åˆ’"
      - "*design <feature>": "ç”ŸæˆæŠ€æœ¯è®¾è®¡"
      - "*review <implementation>": "å®¡æŸ¥ä»£ç è´¨é‡"
      - "*handoff": "ç”Ÿæˆäº¤æ¥æ–‡æ¡£"
      - "*status": "æ˜¾ç¤ºå½“å‰çŠ¶æ€"
      - "*help": "æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤"

  agent_b:
    name: Blake
    role: Execution Master
    terminal: 2

    mandatory_responsibilities:
      - éªŒè¯è®¾è®¡å®Œæ•´æ€§
      - è°ƒç”¨parallel-coordinatorï¼ˆå¤æ‚ä»»åŠ¡å¿…é¡»ï¼‰
      - æ‰§è¡Œæµ‹è¯•éªŒè¯
      - ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Š

    forbidden_actions:
      - "ä¿®æ”¹éœ€æ±‚æ–‡æ¡£"
      - "æ›´æ”¹æ¶æ„è®¾è®¡"
      - "è·³è¿‡æµ‹è¯•"
      - "å¿½ç•¥è®¾è®¡è§„èŒƒ"

    commands:
      - "*execute <handoff>": "æ‰§è¡Œäº¤æ¥ä»»åŠ¡"
      - "*test": "è¿è¡Œæµ‹è¯•å¥—ä»¶"
      - "*deploy": "éƒ¨ç½²åˆ°ç¯å¢ƒ"
      - "*report": "ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Š"
      - "*parallel <tasks>": "å¹¶è¡Œæ‰§è¡Œä»»åŠ¡"

# ==================== Sub-agents å¼ºåˆ¶è°ƒç”¨æœºåˆ¶ ====================
subagents_enforcement:
  # å¼ºåˆ¶è°ƒç”¨è§„åˆ™
  mandatory_invocation_rules:
    agent_a:
      éœ€æ±‚åˆ†æ:
        must_call: ["product-expert"]
        violation: "æœªè°ƒç”¨product-expertè¿›è¡Œéœ€æ±‚åˆ†æ"

      æ¶æ„è®¾è®¡:
        must_call: ["backend-architect"]
        violation: "æœªè°ƒç”¨backend-architectè¿›è¡Œæ¶æ„è®¾è®¡"

      è´¨é‡å®¡æŸ¥:
        must_call: ["code-reviewer"]
        violation: "æœªè°ƒç”¨code-reviewerè¿›è¡Œè´¨é‡å®¡æŸ¥"

    agent_b:
      å¤æ‚ä»»åŠ¡:
        condition: "ä»»åŠ¡åŒ…å«3ä¸ªä»¥ä¸Šç»„ä»¶"
        must_call: ["parallel-coordinator"]
        violation: "å¤æ‚ä»»åŠ¡æœªä½¿ç”¨parallel-coordinator"

      é—®é¢˜ä¿®å¤:
        condition: "é‡åˆ°bugæˆ–é”™è¯¯"
        must_call: ["bug-hunter"]
        violation: "æœªè°ƒç”¨bug-hunterè¯Šæ–­é—®é¢˜"

      æµ‹è¯•æ‰§è¡Œ:
        condition: "å®Œæˆå®ç°å"
        must_call: ["test-runner"]
        violation: "æœªè°ƒç”¨test-runneréªŒè¯å®ç°"

  # è°ƒç”¨éªŒè¯æœºåˆ¶
  invocation_verification:
    log_format: "[{timestamp}] {agent} called {subagent} for {task}"
    verification_points:
      - pre_task: "æ£€æŸ¥æ˜¯å¦éœ€è¦sub-agent"
      - during_task: "ç¡®è®¤sub-agentè¢«è°ƒç”¨"
      - post_task: "éªŒè¯sub-agentå®Œæˆå·¥ä½œ"

  # è¿è§„å¤„ç†
  violation_handling:
    detection: "è‡ªåŠ¨æ£€æµ‹æœªè°ƒç”¨å¿…éœ€çš„sub-agents"
    warning: "âš ï¸ VIOLATION: {violation_message}"
    correction: "ç«‹å³è°ƒç”¨ç¼ºå¤±çš„sub-agent"
    prevention: "é˜»æ­¢ç»§ç»­æ‰§è¡Œç›´åˆ°è°ƒç”¨"

# ==================== æ·±åº¦éœ€æ±‚æŒ–æ˜æµç¨‹ï¼ˆå€Ÿé‰´BMADçš„elicitï¼‰ ====================
requirement_elicitation:
  # å¼ºåˆ¶å¤šè½®ç¡®è®¤æœºåˆ¶
  mandatory_rounds:
    minimum: 3
    maximum: 5

  round1_understanding:
    agent_action:
      - "å¤è¿°ç”¨æˆ·éœ€æ±‚"
      - "è¯†åˆ«å…³é”®ä»·å€¼ç‚¹"
      - "åˆ—å‡ºåˆæ­¥å‡è®¾"
    user_interaction:
      format: "1-9é€‰é¡¹æ ¼å¼"
      options:
        1: "ç»§ç»­ä¸‹ä¸€æ­¥"
        2: "æ¾„æ¸…éœ€æ±‚"
        3: "æä¾›æ›´å¤šèƒŒæ™¯"
        4: "çº æ­£ç†è§£åå·®"
        5: "æ·»åŠ çº¦æŸæ¡ä»¶"
        6: "æ˜ç¡®ä¼˜å…ˆçº§"
        7: "æä¾›ç¤ºä¾‹"
        8: "è®¨è®ºæ›¿ä»£æ–¹æ¡ˆ"
        9: "é‡æ–°å¼€å§‹"

  round2_exploration:
    agent_action:
      - "å±•ç¤ºç†è§£çš„éœ€æ±‚"
      - "æå‡ºclarifying questions"
      - "è¯†åˆ«æ½œåœ¨é£é™©"
    must_check:
      - "å†å²ä»£ç æ˜¯å¦å­˜åœ¨"
      - "ç±»ä¼¼åŠŸèƒ½æ˜¯å¦å®ç°è¿‡"
      - "æ˜¯å¦æœ‰å¯å¤ç”¨ç»„ä»¶"

  round3_confirmation:
    agent_action:
      - "å±•ç¤ºå®Œæ•´éœ€æ±‚ç†è§£"
      - "åˆ—å‡ºå…³é”®å†³ç­–ç‚¹"
      - "ç¡®è®¤éªŒæ”¶æ ‡å‡†"
    final_check:
      format: "å¿…é¡»è·å¾—æ˜ç¡®ç¡®è®¤"
      options:
        - "âœ… ç¡®è®¤ï¼Œå¼€å§‹è®¾è®¡"
        - "ğŸ”„ éœ€è¦è°ƒæ•´"
        - "âŒ é‡æ–°åˆ†æ"

  # æµ…å±‚å“åº”æ£€æµ‹
  shallow_response_detection:
    indicators:
      - "ç«‹å³ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ"
      - "è·³è¿‡ä»·å€¼ç¡®è®¤"
      - "æ²¡æœ‰æå‡ºé—®é¢˜"
      - "å°‘äº3è½®äº¤äº’"
    action: "å¼ºåˆ¶é‡æ–°è¿›å…¥éœ€æ±‚æŒ–æ˜æµç¨‹"

# ==================== åœºæ™¯å·¥ä½œæµï¼ˆå¢å¼ºç‰ˆï¼‰ ====================
scenarios:
  # æ¯ä¸ªåœºæ™¯éƒ½æœ‰å¼ºåˆ¶è¦æ±‚
  new_project:
    trigger: "æ²¡æœ‰ä»»ä½•ä»£ç ï¼Œä»é›¶å¼€å§‹"

    agent_a_workflow:
      phase1_requirements:
        mandatory_subagents: ["product-expert"]
        minimum_time: "30 minutes"
        deliverable: ".tad/active/requirements_v{n}.md"
        user_confirmation: required

      phase2_architecture:
        mandatory_subagents: ["backend-architect", "api-designer"]
        deliverable: ".tad/active/architecture_v{n}.md"
        review_required: true

      phase3_handoff:
        content:
          - "å®Œæ•´éœ€æ±‚æ–‡æ¡£"
          - "æ¶æ„è®¾è®¡å›¾"
          - "å®æ–½æ­¥éª¤"
          - "éªŒæ”¶æ ‡å‡†"
        format: ".tad/active/handoffs/project_init_{timestamp}.md"

    agent_b_workflow:
      phase1_validation:
        check: "éªŒè¯handoffå®Œæ•´æ€§"
        missing_info_action: "è¿”å›Agent Aè¡¥å……"

      phase2_execution:
        mandatory_subagents: ["parallel-coordinator", "devops-engineer"]
        parallel_tasks:
          - "é¡¹ç›®ç»“æ„åˆ›å»º"
          - "åŸºç¡€é…ç½®è®¾ç½®"
          - "å¼€å‘ç¯å¢ƒæ­å»º"

      phase3_testing:
        mandatory_subagents: ["test-runner"]
        coverage_requirement: ">80%"

  bug_fix:
    trigger: "å‘ç°é—®é¢˜éœ€è¦ä¿®å¤"

    agent_a_workflow:
      phase1_analysis:
        mandatory_subagents: ["bug-hunter"]
        deliverable: ".tad/active/tasks/bug_analysis_{id}.md"
        must_include:
          - "é—®é¢˜é‡ç°æ­¥éª¤"
          - "æ ¹å› åˆ†æ"
          - "å½±å“èŒƒå›´"
          - "ä¿®å¤æ–¹æ¡ˆ"

    agent_b_workflow:
      phase1_reproduce:
        action: "å¿…é¡»å…ˆé‡ç°é—®é¢˜"
        failure_action: "è¿”å›Agent Aé‡æ–°åˆ†æ"

      phase2_fix:
        mandatory_subagents: ["bug-hunter", "test-runner"]
        regression_test: required

# ==================== è´¨é‡é—¨æ§ï¼ˆQuality Gatesï¼‰ ====================
quality_gates:
  # Agent A è´¨é‡é—¨æ§
  agent_a_gates:
    gate1_requirement:
      name: "éœ€æ±‚å®Œæ•´æ€§"
      checks:
        - "ç”¨æˆ·ä»·å€¼æ˜ç¡®"
        - "éªŒæ”¶æ ‡å‡†æ¸…æ™°"
        - "è‡³å°‘3è½®ç¡®è®¤"
      violation_action: "é˜»æ­¢è¿›å…¥è®¾è®¡é˜¶æ®µ"

    gate2_design:
      name: "è®¾è®¡å®Œæ•´æ€§"
      checks:
        - "æ‰€æœ‰ç»„ä»¶éƒ½æœ‰è®¾è®¡"
        - "æ•°æ®æµå®Œæ•´"
        - "é”™è¯¯å¤„ç†æ˜ç¡®"
      violation_action: "è¿”å›è¡¥å……è®¾è®¡"

    gate3_handoff:
      name: "äº¤æ¥å®Œæ•´æ€§"
      checks:
        - "å®æ–½æ­¥éª¤è¯¦ç»†"
        - "ä¾èµ–å…³ç³»æ¸…æ™°"
        - "æµ‹è¯•ç”¨ä¾‹æä¾›"
      violation_action: "ç¦æ­¢æäº¤ç»™Agent B"

  # Agent B è´¨é‡é—¨æ§
  agent_b_gates:
    gate1_prereq:
      name: "å‰ç½®æ¡ä»¶"
      checks:
        - "handoffæ–‡æ¡£å­˜åœ¨"
        - "è®¾è®¡å·²æ‰¹å‡†"
        - "ç¯å¢ƒå·²å°±ç»ª"
      violation_action: "æ‹’ç»æ‰§è¡Œ"

    gate2_implementation:
      name: "å®ç°è´¨é‡"
      checks:
        - "ä»£ç å¯ç¼–è¯‘"
        - "å‡½æ•°éƒ½å­˜åœ¨"
        - "ç±»å‹æ£€æŸ¥é€šè¿‡"
      violation_action: "ç«‹å³ä¿®å¤"

    gate3_verification:
      name: "éªŒè¯å®Œæ•´æ€§"
      checks:
        - "æµ‹è¯•å…¨éƒ¨é€šè¿‡"
        - "è¦†ç›–ç‡è¾¾æ ‡"
        - "æ€§èƒ½ç¬¦åˆè¦æ±‚"
      violation_action: "ç¦æ­¢äº¤ä»˜"

# ==================== äº¤äº’åè®® ====================
interaction_protocol:
  # ç”¨æˆ·äº¤äº’æ ¼å¼ï¼ˆå€Ÿé‰´BMADï¼‰
  user_interaction_format:
    standard: "1-9æ•°å­—é€‰é¡¹"
    example: |
      è¯·é€‰æ‹©ï¼š
      1. ç»§ç»­ä¸‹ä¸€æ­¥
      2. æä¾›æ›´å¤šä¿¡æ¯
      3. ä¿®æ”¹å½“å‰å†…å®¹
      4. æŸ¥çœ‹å…¶ä»–é€‰é¡¹
      5. æ·±å…¥è®¨è®º
      6. è¿”å›ä¸Šä¸€æ­¥
      7. ä¿å­˜å¹¶æš‚åœ
      8. æŸ¥çœ‹å¸®åŠ©
      9. é€€å‡º

  # Agenté—´äº¤äº’åè®®
  agent_handoff_protocol:
    format: "æ ‡å‡†åŒ–markdownæ–‡æ¡£"
    required_sections:
      - "## ä»»åŠ¡æ¦‚è¿°"
      - "## èƒŒæ™¯ä¸Šä¸‹æ–‡"
      - "## å…·ä½“è¦æ±‚"
      - "## è®¾è®¡è§„èŒƒ"
      - "## å®æ–½æ­¥éª¤"
      - "## éªŒæ”¶æ ‡å‡†"
      - "## æ³¨æ„äº‹é¡¹"

  # è¿è§„æç¤º
  violation_alerts:
    format: |
      âš ï¸ VIOLATION DETECTED âš ï¸
      Type: {violation_type}
      Agent: {agent_name}
      Action: {forbidden_action}
      Correction: {required_correction}

# ==================== ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ ====================
task_management:
  task_id_format: "TASK-{YYYY}{MM}{DD}-{3ä½åºå·}"

  task_states:
    - "pending": "å¾…å¼€å§‹"
    - "in_progress": "è¿›è¡Œä¸­"
    - "blocked": "è¢«é˜»å¡"
    - "review": "å®¡æŸ¥ä¸­"
    - "completed": "å·²å®Œæˆ"
    - "archived": "å·²å½’æ¡£"

  task_tracking:
    location: ".tad/active/tasks/"
    format: "{task_id}_tracking.yaml"
    required_fields:
      - task_id
      - title
      - status
      - owner
      - created
      - updated
      - dependencies
      - blockers
      - deliverables

  dependency_management:
    check_before_start: true
    block_if_unmet: true
    alert_on_circular: true

# ==================== ç›‘æ§ä¸æŠ¥å‘Š ====================
monitoring:
  violation_log:
    location: ".tad/logs/violations.log"
    format: "[{timestamp}] {agent} - {violation} - {action_taken}"

  subagent_usage_log:
    location: ".tad/logs/subagent_usage.log"
    format: "[{timestamp}] {agent} â†’ {subagent} for {task}"

  performance_metrics:
    track:
      - "éœ€æ±‚ç¡®è®¤è½®æ¬¡"
      - "è®¾è®¡è¿­ä»£æ¬¡æ•°"
      - "sub-agentè°ƒç”¨ç‡"
      - "è¿è§„æ¬¡æ•°"
      - "è¿”å·¥ç‡"

  daily_report:
    generate: true
    location: ".tad/reports/daily_{date}.md"
    include:
      - "ä»»åŠ¡å®Œæˆæƒ…å†µ"
      - "è¿è§„ç»Ÿè®¡"
      - "sub-agentä½¿ç”¨ç»Ÿè®¡"
      - "è´¨é‡é—¨æ§é€šè¿‡ç‡"

# ==================== å‘½ä»¤ç³»ç»Ÿ ====================
command_system:
  prefix: "*"

  global_commands:
    - "*help": "æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤"
    - "*status": "æ˜¾ç¤ºå½“å‰çŠ¶æ€"
    - "*tasks": "æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨"
    - "*history": "æ˜¾ç¤ºå†å²è®°å½•"
    - "*config": "æ˜¾ç¤ºå½“å‰é…ç½®"

  agent_specific_commands:
    agent_a:
      - "*analyze <requirement>": "æ·±åº¦éœ€æ±‚åˆ†æ"
      - "*design <feature>": "åˆ›å»ºæŠ€æœ¯è®¾è®¡"
      - "*review <code>": "ä»£ç å®¡æŸ¥"
      - "*handoff": "ç”Ÿæˆäº¤æ¥æ–‡æ¡£"
      - "*call <subagent>": "è°ƒç”¨sub-agent"

    agent_b:
      - "*execute <handoff>": "æ‰§è¡Œäº¤æ¥ä»»åŠ¡"
      - "*parallel <tasks>": "å¹¶è¡Œæ‰§è¡Œ"
      - "*test": "è¿è¡Œæµ‹è¯•"
      - "*deploy": "éƒ¨ç½²åº”ç”¨"
      - "*report": "ç”ŸæˆæŠ¥å‘Š"

# ==================== MCP å·¥å…·é›†æˆ (v1.2 æ–°å¢) ====================
mcp_tools:
  enabled: true
  version: "1.2"
  registry_file: ".tad/mcp-registry.yaml"
  description: "MCP tools enhance TAD agents but are NOT required for core functionality"

  # Agent A (Alex) - Solution Lead MCP é…ç½®
  agent_a_tools:
    core_layer:
      tools: ["context7", "sequential-thinking", "memory-bank", "brave-search"]
      description: "æ ¸å¿ƒå±‚å·¥å…·,å¢å¼ºéœ€æ±‚åˆ†æå’Œè®¾è®¡èƒ½åŠ›"

    auto_trigger:
      context7:
        description: "æ£€æµ‹åˆ°æ¡†æ¶/åº“å…³é”®è¯æ—¶è‡ªåŠ¨è°ƒç”¨æœ€æ–°æ–‡æ¡£"
        keywords:
          - "Next.js"
          - "React"
          - "Vue"
          - "Tailwind"
          - "TypeScript"
          - "Supabase"
          - "æ¡†æ¶"
          - "åº“"
        action: "auto_call"
        timing: "Round 1-2 ä¹‹é—´"

      memory-bank:
        description: "éœ€æ±‚åˆ†æå¼€å§‹å‰æ¨èè°ƒç”¨é¡¹ç›®å†å²"
        action: "recommend"
        timing:
          - "Round 0 (éœ€æ±‚åˆ†æå¼€å§‹)"
          - "è®¾è®¡é˜¶æ®µå¼€å§‹"
          - "å›é¡¾å†å²å†³ç­–æ—¶"

      sequential-thinking:
        description: "å¤æ‚é—®é¢˜åˆ†è§£æ—¶å»ºè®®ä½¿ç”¨"
        keywords: ["å¤æ‚", "æ¶æ„", "ç³»ç»Ÿè®¾è®¡", "ç®—æ³•"]
        action: "suggest"

      brave-search:
        description: "æŠ€æœ¯ä¸ç¡®å®šæ—¶å»ºè®®è°ƒç ”"
        action: "suggest"
        timing: ["Round 2 æŠ€æœ¯ç ”ç©¶"]

    workflow_integration:
      requirement_analysis:
        - "Round 0: RECOMMEND memory-bank"
        - "Round 1-2: AUTO-TRIGGER context7 on framework mention"
        - "Round 2: SUGGEST brave-search if technical uncertainty"
        - "Round 2.5: AUTO-DETECT project type and recommend Project MCPs"

      design_phase:
        - "USE context7 for latest best practices"
        - "USE sequential-thinking for complex architecture"
        - "USE memory-bank to review past decisions"

      handoff_creation:
        - "INCLUDE MCP tools used in handoff document"
        - "RECOMMEND Blake which Project MCPs to use"

    forbidden_mcp_tools:
      description: "Alex ä¸åº”ä½¿ç”¨çš„ MCP (Blake's domain)"
      list:
        - "filesystem"  # Blake çš„æ–‡ä»¶æ“ä½œ
        - "git"         # Blake çš„ç‰ˆæœ¬æ§åˆ¶
        - "docker"      # Blake çš„å®¹å™¨ç®¡ç†
        - "kubernetes"  # Blake çš„éƒ¨ç½²
        - "terminal"    # Blake çš„å‘½ä»¤æ‰§è¡Œ

  # Agent B (Blake) - Execution Master MCP é…ç½®
  agent_b_tools:
    core_layer:
      tools: ["filesystem", "git", "github"]
      required: ["filesystem", "git"]
      description: "æ ¸å¿ƒå±‚å·¥å…·,å®ç°å¼€å‘å¿…å¤‡"

    project_layer:
      description: "æ ¹æ® Alex åœ¨ Round 2.5 æ¨èçš„é¡¹ç›®ç±»å‹å·¥å…·"
      examples:
        web_fullstack: ["supabase", "playwright", "vercel", "react-mcp"]
        data_science: ["jupyter", "pandas-mcp", "antv-chart", "postgres-mcp-pro"]
        machine_learning: ["jupyter", "optuna", "huggingface", "zenml"]
        devops: ["kubernetes", "docker", "aws", "terminal"]
        creative: ["figma", "video-audio-mcp", "adobe-mcp"]

    auto_use:
      filesystem:
        description: "æ‰€æœ‰æ–‡ä»¶åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹æ“ä½œè‡ªåŠ¨ä½¿ç”¨"
        operations: ["create", "read", "update", "delete", "list"]

      git:
        description: "æ‰€æœ‰ç‰ˆæœ¬æ§åˆ¶æ“ä½œè‡ªåŠ¨ä½¿ç”¨"
        operations: ["commit", "branch", "merge", "status"]

      context7:
        description: "å®ç°æ¡†æ¶ä»£ç æ—¶è‡ªåŠ¨è§¦å‘"
        trigger: "when implementing framework-specific code"

    workflow_integration:
      pre_implementation:
        - "VERIFY filesystem MCP is active"
        - "VERIFY git MCP is active"
        - "CHECK project MCPs from handoff recommendation"
        - "HALT if required MCPs unavailable"

      during_implementation:
        - "AUTO-USE filesystem for all file operations"
        - "AUTO-USE git for version control"
        - "AUTO-TRIGGER context7 when implementing framework code"
        - "USE project MCPs as recommended by Alex"

      testing_phase:
        - "USE playwright MCP for E2E tests (if available)"
        - "USE terminal MCP for test execution"

      deployment:
        - "USE vercel/aws MCP for deployment (if configured)"
        - "USE kubernetes/docker MCP for container deployment"

    pre_flight_checks:
      description: "Run before *develop command"
      checklist:
        - check: "filesystem MCP active"
          action_if_fail: "HALT - Cannot proceed without filesystem access"
          severity: "blocking"

        - check: "git MCP active"
          action_if_fail: "HALT - Cannot proceed without version control"
          severity: "blocking"

        - check: "handoff document exists"
          action_if_fail: "HALT - Cannot start without handoff from Alex"
          severity: "blocking"

        - check: "project MCPs availability"
          action_if_fail: "WARN - Suggest installing recommended MCPs"
          severity: "warning"

  # MCP ä½¿ç”¨å¼ºåˆ¶æœºåˆ¶
  enforcement:
    mode: "recommend"
    description: "æ¨èæ¨¡å¼ - MCP æ˜¯å¢å¼º,ä¸æ˜¯å¿…éœ€"

    violation_detection:
      enabled: true
      checks:
        - "Blake å°è¯•å¼€å§‹ *develop ä½† filesystem MCP ä¸å¯ç”¨"
        - "Blake å°è¯•å¼€å§‹ *develop ä½† git MCP ä¸å¯ç”¨"
        - "Alex è°ƒç”¨äº† filesystem/git MCP (violation - Blake's domain)"

    violation_action: "warn"
    violation_format: |
      âš ï¸ MCP VIOLATION âš ï¸
      Agent: {agent_name}
      Issue: {violation_description}
      Action: {required_correction}

    non_blocking:
      description: "MCP å·¥å…·ä¸å¯ç”¨æ—¶ä¸é˜»å¡åŸæœ‰ TAD å·¥ä½œæµ"
      fallback: "ä½¿ç”¨ Claude Code å†…ç½®èƒ½åŠ›ç»§ç»­æ‰§è¡Œ"
      log: "è®°å½• MCP ä¸å¯ç”¨æƒ…å†µä¾›åç»­æ”¹è¿›"

  # MCP å®‰å…¨é…ç½®
  security:
    auto_approve_readonly: true
    description: "åªè¯»æ“ä½œè‡ªåŠ¨æ‰¹å‡†,å±é™©æ“ä½œéœ€ç¡®è®¤"

    auto_approve_safe:
      - "git status"
      - "git diff"
      - "git log"
      - "filesystem read operations"
      - "context7 documentation queries"
      - "memory-bank history queries"

    always_confirm:
      - "git push"
      - "git push --force"
      - "rm -rf"
      - "filesystem delete operations"
      - "docker rm"
      - "kubectl delete"
      - "vercel deploy --prod"
      - "aws operations"

  # Project Type Detection Integration
  project_detection:
    enabled: true
    timing: "Round 2.5 (after tech stack confirmed)"
    confidence_threshold:
      web_fullstack: 0.7
      data_science: 0.6
      machine_learning: 0.8
      devops: 0.7
      creative: 0.7

    detection_method:
      - "Keywords in user responses"
      - "File patterns in existing codebase"
      - "Tech stack preferences"

    action_on_detection:
      - "Display project type and confidence"
      - "Show recommended Project-Layer MCPs"
      - "Offer installation options (0-2)"
      - "Record user decision"
      - "Continue to Round 3 regardless of choice"

  # MCP æ•ˆç‡æå‡è¿½è¸ª
  efficiency_tracking:
    enabled: true
    metrics:
      - "MCP tools used per task"
      - "Time saved estimates"
      - "Documentation accuracy improvements"
      - "Code quality improvements"

    reporting:
      location: ".tad/logs/mcp_usage.log"
      format: "[{timestamp}] {agent} used {mcp_tool} for {task} - Estimated time saved: {minutes}m"

  # é‡è¦æé†’
  important_notes:
    - "MCP å·¥å…·æ˜¯ ENHANCEMENTS,ä¸æ˜¯ REQUIREMENTS"
    - "æ‰€æœ‰åŸæœ‰ TAD å·¥ä½œæµåœ¨æ²¡æœ‰ MCP çš„æƒ…å†µä¸‹ä»å®Œå…¨å¯ç”¨"
    - "MCP å·¥å…·å¤±è´¥æ—¶ä¸åº”é˜»æ­¢è¿›åº¦"
    - "å§‹ç»ˆé€šçŸ¥ç”¨æˆ·æ­£åœ¨ä½¿ç”¨å“ªäº› MCP å·¥å…·"
    - "MCP æ•…éšœåº”è®°å½•ä½†ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½"
    - "filesystem å’Œ git æ˜¯ Blake çš„å¿…éœ€ MCP,å…¶ä»–éƒ½æ˜¯å¯é€‰"

# ==================== YOLOæ¨¡å¼ï¼ˆå¯é€‰ï¼‰ ====================
yolo_mode:
  enabled: false
  activation: "#yolo"
  warning: "âš ï¸ YOLOæ¨¡å¼ä¼šè·³è¿‡éƒ¨åˆ†éªŒè¯æ­¥éª¤ï¼Œä»…åœ¨ç´§æ€¥æƒ…å†µä½¿ç”¨"
  restrictions:
    - "ä»éœ€éµå®ˆè§’è‰²è¾¹ç•Œ"
    - "ä¸èƒ½è·³è¿‡å…³é”®è´¨é‡é—¨æ§"
    - "å¿…é¡»è®°å½•åŸå› "

# ==================== TAD v1.3 å¢å¼ºé…ç½® ====================
# åˆ›å»ºæ—¥æœŸ: 2025-11-25
# åŸºäº: MenuSnapé¡¹ç›®å®è¯åˆ†æ + ä¸‰ä»½æ ¸å¿ƒæ–‡æ¡£
# ç›®æ ‡: è¯æ®å¼è´¨é‡ä¿è¯ + Humanå¯è§†åŒ–èµ‹èƒ½ + æŒç»­å­¦ä¹ 

tad_version: 1.3.0
enhancement_date: 2025-11-25
philosophy: "Evidence-Based Triangle Development with Continuous Learning"

# ==================== è¯æ®å¼éªŒè¯ç³»ç»Ÿ ====================
evidence_based_verification:
  enabled: true
  description: "æ‰€æœ‰å…³é”®æ£€æŸ¥ç‚¹éƒ½éœ€è¦æä¾›å¯éªŒè¯çš„è¯æ®"

  required_evidence_types:
    # è¯æ®ç±»å‹1ï¼šæœç´¢ç»“æœ
    search_result:
      format: "å‘½ä»¤ + ç»“æœæˆªå›¾æˆ–æ–‡æœ¬è¾“å‡º"
      purpose: "è¯æ˜ç¡®å®æœç´¢äº†å†å²ä»£ç "
      example: |
        ```bash
        # æœç´¢å‘½ä»¤
        grep -r "calculateScore" src/

        # ç»“æœ
        src/lib/utils.ts:42: export function calculateScoreAndReasons(...)
        ```
      human_validation: "èƒ½çœ‹åˆ°æœç´¢å‘½ä»¤å’Œç»“æœ"
      mandatory_for: ["MQ1"]

    # è¯æ®ç±»å‹2ï¼šä»£ç ä½ç½®è¯æ˜
    code_location:
      format: "Markdownè¡¨æ ¼ï¼šå‡½æ•°å | æ–‡ä»¶ä½ç½® | è¡Œå· | ä»£ç ç‰‡æ®µ | éªŒè¯çŠ¶æ€"
      purpose: "è¯æ˜å‡½æ•°/ç»„ä»¶ç¡®å®å­˜åœ¨"
      example: |
        | å‡½æ•°å | ä½ç½® | è¡Œå· | ä»£ç ç‰‡æ®µ | éªŒè¯ |
        |--------|------|------|---------|------|
        | calculateScore | src/lib/utils.ts | 42 | `export function calculateScore(...)` | âœ… |
      human_validation: "èƒ½çœ‹åˆ°å…·ä½“ä½ç½®å’Œä»£ç ï¼Œæ¯ä¸ªéƒ½æ ‡è®°âœ…"
      mandatory_for: ["MQ2"]

    # è¯æ®ç±»å‹3ï¼šæ•°æ®æµå›¾
    data_flow_diagram:
      format: "Mermaidå›¾ + Markdownå¯¹ç…§è¡¨"
      purpose: "å±•ç¤ºæ•°æ®ä»åç«¯åˆ°å‰ç«¯çš„å®Œæ•´æµåŠ¨"
      example: |
        ```mermaid
        graph LR
          A[Backend API] -->|è®¡ç®—| B[score, reasons, warnings]
          B -->|ä¼ é€’| C[Frontend]
          C -->|æ˜¾ç¤º| D[ScoreDisplay]
          C -->|æ˜¾ç¤º| E[ReasonList]
          C -->|æ˜¾ç¤º| F[WarningAlert]
        ```

        | åç«¯å­—æ®µ | å‰ç«¯ç»„ä»¶ | æ˜¯å¦æ˜¾ç¤º | ä¸æ˜¾ç¤ºåŸå›  |
        |---------|---------|---------|-----------|
        | score | ScoreDisplay | âœ… | - |
        | matchReasons | ReasonList | âœ… | - |
      human_validation: "èƒ½çœ‹åˆ°æ¯ä¸ªå­—æ®µéƒ½æœ‰å¯¹åº”çš„æ˜¾ç¤ºç»„ä»¶ï¼Œæˆ–æœ‰åˆç†çš„ä¸æ˜¾ç¤ºåŸå› "
      mandatory_for: ["MQ3"]

    # è¯æ®ç±»å‹4ï¼šçŠ¶æ€æµå›¾
    state_flow_diagram:
      format: "ASCIIå›¾æˆ–MermaidçŠ¶æ€å›¾"
      purpose: "å±•ç¤ºçŠ¶æ€çš„æ¥æºã€å­˜å‚¨ä½ç½®ã€åŒæ­¥æ—¶æœº"
      example: |
        [ç”¨æˆ·è¾“å…¥] â†’ preferences.allergens (ä¸»çŠ¶æ€ï¼ŒSource of Truth)
                      â†“ åŒæ­¥æ—¶æœºï¼šonSubmitäº‹ä»¶
                   dietaryRestrictions.allergies (å¤‡ä»½çŠ¶æ€)
      human_validation: "èƒ½çœ‹åˆ°æ˜¯å¦æœ‰å¤šå¤„å­˜å‚¨ã€è°æ˜¯ä¸»çŠ¶æ€ã€ä½•æ—¶åŒæ­¥"
      mandatory_for: ["MQ5"]

    # è¯æ®ç±»å‹5ï¼šUIæˆªå›¾
    ui_screenshot:
      format: "æµè§ˆå™¨æˆªå›¾æˆ–UI mockup"
      purpose: "è¯æ˜åŠŸèƒ½çš„è§†è§‰æ•ˆæœ"
      example: "æµè§ˆå™¨æˆªå›¾æ˜¾ç¤ºæ¨èç†ç”±å’Œè­¦å‘Šçš„è§†è§‰å±‚çº§"
      human_validation: "èƒ½çœ‹åˆ°å®é™…æ˜¾ç¤ºæ•ˆæœï¼Œè§†è§‰å±‚çº§æ¸…æ™°"
      mandatory_for: ["MQ4", "Phaseå®ŒæˆæŠ¥å‘Š"]

    # è¯æ®ç±»å‹6ï¼šæµ‹è¯•ç»“æœ
    test_result:
      format: "æµ‹è¯•è¿è¡Œæˆªå›¾æˆ–æ—¥å¿—è¾“å‡º"
      purpose: "è¯æ˜ä»£ç èƒ½è¿è¡Œã€æµ‹è¯•é€šè¿‡"
      example: |
        ```
        âœ“ 42 tests passing
        âœ“ Coverage: 87%
        ```
      human_validation: "èƒ½çœ‹åˆ°æµ‹è¯•é€šè¿‡ï¼ˆpassed/ç»¿è‰²âœ“ï¼‰ï¼Œè¦†ç›–ç‡è¾¾æ ‡"
      mandatory_for: ["Phaseå®ŒæˆæŠ¥å‘Š"]

# ==================== å¼ºåˆ¶å›ç­”é—®é¢˜ç³»ç»Ÿ ====================
mandatory_questions:
  enabled: true
  blocking: true
  auto_sync: true
  source: ".tad/evidence/patterns/failure-patterns.md"
  description: "ä»å†å²å¤±è´¥ä¸­æç‚¼çš„å¿…é¡»å›ç­”çš„é—®é¢˜"

  # é—®é¢˜åº“
  questions:
    MQ1_historical_code:
      id: "MQ1"
      pattern_source: "Failure Pattern 2: Creating Instead of Searching"
      trigger_keywords: ["ä¹‹å‰çš„", "åŸæ¥çš„", "æˆ‘ä»¬çš„æ–¹æ¡ˆ", "previous", "original", "existing"]
      trigger_condition: "ç”¨æˆ·æè¿°ä¸­æåˆ°å†å²æ–¹æ¡ˆæˆ–ç°æœ‰åŠŸèƒ½"

      question: "ç”¨æˆ·æåˆ°äº†å†å²æ–¹æ¡ˆï¼Œä½ æ‰¾åˆ°ç›¸å…³ä»£ç äº†å—ï¼Ÿ"
      sub_questions:
        - "æœç´¢äº†å“ªäº›å…³é”®è¯ï¼Ÿ"
        - "æ‰¾åˆ°äº†ä»€ä¹ˆï¼Ÿåœ¨å“ªé‡Œï¼Ÿ"
        - "ä¸ºä»€ä¹ˆå†³å®šå¤ç”¨/ä¸å¤ç”¨ï¼Ÿ"

      required_evidence: "search_result"
      evidence_format: "æœç´¢å‘½ä»¤ + å®Œæ•´è¾“å‡º + å†³ç­–è¯´æ˜"
      blocking: true

      human_validation_question: "èƒ½çœ‹åˆ°æœç´¢ç¡®å®æ‰§è¡Œäº†å—ï¼Ÿå†³ç­–ç†ç”±åˆç†å—ï¼Ÿ"

    MQ2_function_existence:
      id: "MQ2"
      pattern_source: "Failure Pattern 3: Function Assumption Errors"
      trigger_condition: "è®¾è®¡ä¸­åŒ…å«å‡½æ•°è°ƒç”¨æˆ–ç»„ä»¶å¼•ç”¨"

      question: "è®¾è®¡ä¸­è°ƒç”¨äº†å“ªäº›å‡½æ•°/ç»„ä»¶ï¼Ÿå®ƒä»¬éƒ½å­˜åœ¨å—ï¼Ÿ"
      sub_questions:
        - "åˆ—å‡ºæ‰€æœ‰å°†è°ƒç”¨çš„å‡½æ•°/ç»„ä»¶"
        - "æ¯ä¸ªå‡½æ•°åœ¨å“ªä¸ªæ–‡ä»¶çš„ç¬¬å‡ è¡Œï¼Ÿ"
        - "è¯·æä¾›å‡½æ•°å®šä¹‰çš„ä»£ç ç‰‡æ®µ"

      required_evidence: "code_location"
      evidence_format: "Markdownè¡¨æ ¼ï¼Œæ¯ä¸ªå‡½æ•°/ç»„ä»¶éƒ½æœ‰ä½ç½®è¯æ˜"
      blocking: true

      human_validation_question: "æ¯ä¸ªå‡½æ•°éƒ½æœ‰âœ…å­˜åœ¨æ ‡è®°å’Œå…·ä½“ä½ç½®å—ï¼Ÿ"

    MQ3_data_flow:
      id: "MQ3"
      pattern_source: "Failure Pattern 4: Incomplete Data Flow"
      trigger_condition: "åç«¯è®¡ç®—æˆ–è¿”å›æ•°æ®ç»™å‰ç«¯"

      question: "åç«¯è®¡ç®—/è¿”å›äº†å“ªäº›å­—æ®µï¼Ÿå‰ç«¯éƒ½æ˜¾ç¤ºäº†å—ï¼Ÿ"
      sub_questions:
        - "åç«¯è¿”å›çš„å®Œæ•´å­—æ®µåˆ—è¡¨"
        - "æ¯ä¸ªå­—æ®µåœ¨å‰ç«¯çš„å“ªä¸ªç»„ä»¶æ˜¾ç¤ºï¼Ÿ"
        - "æœ‰æ²¡æœ‰å­—æ®µä¸æ˜¾ç¤ºï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"

      required_evidence: "data_flow_diagram"
      evidence_format: "æ•°æ®æµå›¾ï¼ˆMermaidï¼‰+ å¯¹ç…§è¡¨"
      blocking: true

      human_validation_question: |
        - åç«¯æ¯ä¸ªå­—æ®µéƒ½æœ‰å¯¹åº”çš„å‰ç«¯ç»„ä»¶å—ï¼Ÿ
        - "âŒä¸æ˜¾ç¤º"çš„å­—æ®µæœ‰åˆç†åŸå› å—ï¼Ÿ

    MQ4_visual_hierarchy:
      id: "MQ4"
      pattern_source: "Failure Pattern 5: Visual Uniformity Disease"
      trigger_condition: "åŠŸèƒ½æœ‰å¤šä¸ªçŠ¶æ€ã€ç±»å‹æˆ–ä¼˜å…ˆçº§"

      question: "è¿™ä¸ªåŠŸèƒ½æœ‰ä¸åŒçš„çŠ¶æ€/ç±»å‹å—ï¼Ÿç”¨æˆ·å¦‚ä½•è§†è§‰ä¸ŠåŒºåˆ†ï¼Ÿ"
      sub_questions:
        - "æœ‰å“ªäº›ä¸åŒçš„çŠ¶æ€ï¼Ÿï¼ˆå¦‚ï¼šæ¨è/ä¸æ¨èï¼ŒæˆåŠŸ/å¤±è´¥ï¼‰"
        - "æ¯ä¸ªçŠ¶æ€çš„è§†è§‰è¡¨ç°æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆé¢œè‰²ã€å›¾æ ‡ã€æ–‡å­—ï¼‰"
        - "ç”¨æˆ·èƒ½ä¸€çœ¼çœ‹å‡ºåŒºåˆ«å—ï¼Ÿ"

      required_evidence: "ui_screenshot"
      evidence_format: "UIçŠ¶æ€å¯¹æ¯”è¡¨ + æˆªå›¾/mockup"
      blocking: false  # è­¦å‘Šä½†ä¸é˜»å¡

      human_validation_question: "ä»æˆªå›¾èƒ½çœ‹å‡ºä¸åŒçŠ¶æ€çš„æ˜æ˜¾åŒºåˆ«å—ï¼Ÿ"

    MQ5_state_sync:
      id: "MQ5"
      pattern_source: "Real Issue: Dual State Sync Problem"
      trigger_condition: "æ¶‰åŠç”¨æˆ·è¾“å…¥ã€çŠ¶æ€ç®¡ç†æˆ–å‰åç«¯æ•°æ®ä¼ é€’"

      question: "æ•°æ®å­˜åœ¨å‡ ä¸ªåœ°æ–¹ï¼Ÿå®ƒä»¬ä»€ä¹ˆæ—¶å€™åŒæ­¥ï¼Ÿ"
      sub_questions:
        - "åˆ—å‡ºæ‰€æœ‰å­˜å‚¨è¿™ä¸ªæ•°æ®çš„åœ°æ–¹ï¼ˆå‰ç«¯state/localStorage/åç«¯session/databaseï¼‰"
        - "å“ªä¸ªæ˜¯ä¸»çŠ¶æ€ï¼ˆSource of Truthï¼‰ï¼Ÿ"
        - "å…¶ä»–çŠ¶æ€ä»€ä¹ˆæ—¶å€™åŒæ­¥ï¼Ÿç”¨ä»€ä¹ˆè§¦å‘ï¼Ÿ"
        - "å¦‚æœå¿˜è®°åŒæ­¥ä¼šæ€æ ·ï¼Ÿç”¨æˆ·ä¼šçœ‹åˆ°ä»€ä¹ˆï¼Ÿ"

      required_evidence: "state_flow_diagram"
      evidence_format: "çŠ¶æ€æµå›¾ï¼Œæ ‡æ³¨ä¸»çŠ¶æ€ã€åŒæ­¥æ—¶æœºå’Œè§¦å‘æ¡ä»¶"
      blocking: true

      human_validation_question: |
        - æ¸…æ¥šæ ‡æ³¨å“ªä¸ªæ˜¯ä¸»çŠ¶æ€äº†å—ï¼Ÿ
        - åŒæ­¥æ—¶æœºæ˜ç¡®å—ï¼Ÿ
        - æˆ–ç¡®è®¤åªæœ‰å•ä¸€çŠ¶æ€ï¼Ÿ

  # æ‰§è¡Œæœºåˆ¶
  enforcement:
    when: "Gate 2 (Design Completeness)"
    how: "Alexå¿…é¡»åœ¨handoffä¸­åŒ…å«'å¼ºåˆ¶é—®é¢˜å›ç­”'ç« èŠ‚"
    validation: "Humanæ£€æŸ¥æ¯ä¸ªè§¦å‘çš„MQæ˜¯å¦éƒ½æœ‰å›ç­”+è¯æ®"
    consequence_missing: "è¯æ®ä¸å®Œæ•´ â†’ é˜»æ­¢æäº¤handoffï¼Œè¦æ±‚è¡¥å……"
    consequence_incomplete: "è¯æ®è´¨é‡ä½ â†’ Humanè¦æ±‚é‡æ–°æä¾›"

  # è‡ªåŠ¨æ›´æ–°æœºåˆ¶
  auto_update_pipeline:
    trigger: "Humançº æ­£äº†AIçš„é”™è¯¯æˆ–å‘ç°æ–°çš„å¤±è´¥æ¨¡å¼"
    process: |
      1. æ•è·é”™è¯¯ç±»å‹å’Œæ ¹å› ï¼ˆåˆ›å»ºFailure Learning Entryï¼‰
      2. åˆ¤æ–­ï¼šè¿™ä¸ªé”™è¯¯åº”è¯¥ç”±å“ªä¸ªMQæ‹¦æˆªï¼Ÿ
      3. å¦‚æœç°æœ‰MQæœªè¦†ç›–ï¼š
         - ç”Ÿæˆæ–°MQå»ºè®®ï¼ˆMQ6ã€MQ7...ï¼‰
         - æäº¤Humanå®¡æ ¸
         - å®¡æ ¸é€šè¿‡åè‡ªåŠ¨æ·»åŠ åˆ°config.yaml
      4. å¦‚æœç°æœ‰MQåº”è¯¥æ‹¦æˆªä½†æ²¡æ‹¦ï¼š
         - åˆ†æä¸ºä»€ä¹ˆæ²¡æ‹¦ä½ï¼ˆtriggeræ¡ä»¶ä¸å¤Ÿï¼Ÿevidenceä¸å¤Ÿï¼Ÿï¼‰
         - ä¼˜åŒ–MQçš„triggeræ¡ä»¶æˆ–evidenceè¦æ±‚
         - æ›´æ–°config.yaml
    output_location: ".tad/evidence/failures/[timestamp]_mq_update.yaml"

# ==================== æ¸è¿›å¼éªŒè¯ç³»ç»Ÿ ====================
progressive_validation:
  enabled: true
  description: "å°†å¤§ä»»åŠ¡åˆ†è§£ä¸ºPhaseï¼Œæ¯ä¸ªPhaseåHumanéªŒè¯"

  phase_structure:
    definition: |
      Phaseæ˜¯åŠŸèƒ½çš„é€»è¾‘ç»„æˆéƒ¨åˆ†ï¼Œæ¯ä¸ªPhaseï¼š
      - æœ‰æ˜ç¡®çš„äº¤ä»˜ç‰©ï¼ˆä»£ç ã€æ–‡æ¡£ã€æµ‹è¯•ï¼‰
      - æœ‰ç‹¬ç«‹çš„éªŒè¯æ ‡å‡†
      - å®Œæˆåéœ€è¦Humanå®¡æŸ¥æ‰èƒ½ç»§ç»­

    size_guideline:
      small_task: "1ä¸ªPhaseï¼Œ1-2å°æ—¶å®Œæˆ"
      medium_task: "2-3ä¸ªPhaseï¼Œæ¯ä¸ªPhase 2-3å°æ—¶"
      large_task: "4-6ä¸ªPhaseï¼Œæ¯ä¸ªPhaseä¸è¶…è¿‡4å°æ—¶"

    mandatory_checkpoint: "æ¯ä¸ªPhaseå®Œæˆæ—¶Blakeå¿…é¡»æä¾›è¯æ®ï¼ŒHumanå¿…é¡»å®¡æŸ¥"

  phase_evidence_requirements:
    every_phase_must_provide:
      - code_screenshot: "å…³é”®å‡½æ•°/ç»„ä»¶çš„ä»£ç æˆªå›¾"
      - test_result: "è¯¥Phaseç›¸å…³çš„æµ‹è¯•ç»“æœ"
      - ui_screenshot: "å¦‚æœæœ‰UIå˜åŒ–ï¼Œæä¾›æµè§ˆå™¨æˆªå›¾"
      - progress_notes: "é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•"

    human_checkpoint_questions:
      - "è¿™æ˜¯æˆ‘æœŸæœ›çš„æ–¹å‘å—ï¼Ÿ"
      - "æµ‹è¯•é€šè¿‡äº†å—ï¼Ÿï¼ˆçœ‹åˆ°passed/ç»¿è‰²âœ“ï¼‰"
      - "éœ€è¦è°ƒæ•´ä»€ä¹ˆå—ï¼Ÿ"

    continue_criteria: "Humanç¡®è®¤æ–¹å‘æ­£ç¡®"
    adjustment_process: "å¦‚æœéœ€è¦è°ƒæ•´ï¼ŒBlakeä¿®æ”¹æœ¬Phaseåé‡æ–°æäº¤è¯æ®"

  gate_phase_binding:
    description: "å°†Quality Gatesç»‘å®šåˆ°Phase"

    gate2_design_phases:
      phase: "è®¾è®¡é˜¶æ®µå„Phaseï¼ˆå¦‚æœè®¾è®¡åˆ†å¤šä¸ªPhaseï¼‰"
      checkpoint_type: "design_evidence"
      timing: "æ¯å®Œæˆä¸€ä¸ªè®¾è®¡æ¨¡å—"
      human_action: "å®¡æŸ¥è®¾è®¡å›¾è¡¨å’Œè¯æ®"

    gate3_implementation_phases:
      phase: "å®ç°é˜¶æ®µå„Phase"
      checkpoint_type: "implementation_evidence"
      timing: "æ¯å®Œæˆä¸€ä¸ªPhase"
      human_action: "å®¡æŸ¥ä»£ç æˆªå›¾ã€æµ‹è¯•ç»“æœã€UIæ•ˆæœ"
      continue_criteria: "Humanç¡®è®¤æ–¹å‘æ­£ç¡®æ‰èƒ½ç»§ç»­ä¸‹ä¸ªPhase"

# ==================== Humanè§’è‰²å¢å¼º ====================
human_role_v13:
  role_name: "Value Guardian + Checkpoint Validator"

  role_evolution:
    from: "è¢«åŠ¨éªŒæ”¶è€…ï¼ˆåªåœ¨æœ€åéªŒæ”¶ï¼‰"
    to: "ä¸»åŠ¨éªŒè¯è€…ï¼ˆå‚ä¸è®¾è®¡å®¡æŸ¥å’Œæ¸è¿›æ£€æŸ¥ï¼‰+ å­¦ä¹ è€…ï¼ˆæ¯ä¸ªé¡¹ç›®éƒ½åœ¨æˆé•¿ï¼‰"

  responsibilities:
    value_guardian:
      tasks:
        - "å®šä¹‰ä¸šåŠ¡ä»·å€¼å’Œéœ€æ±‚"
        - "éªŒè¯æœ€ç»ˆäº¤ä»˜çš„ä»·å€¼"
        - "åšå…³é”®ä¸šåŠ¡å†³ç­–"
      time_investment: "éœ€æ±‚é˜¶æ®µï¼š30-60åˆ†é’Ÿ"

    checkpoint_validator:
      tasks:
        - "å®¡æŸ¥è®¾è®¡é˜¶æ®µçš„è¯æ®ï¼ˆå›¾è¡¨ã€è¡¨æ ¼ï¼‰"
        - "å®¡æŸ¥å®ç°é˜¶æ®µçš„è¯æ®ï¼ˆæˆªå›¾ã€æµ‹è¯•ç»“æœï¼‰"
        - "ç¡®è®¤æ¯ä¸ªPhaseæ–¹å‘æ­£ç¡®"
      time_investment: "æ¯ä¸ªPhaseï¼š5-15åˆ†é’Ÿ"
      skill_required: "ä¸éœ€è¦æŠ€æœ¯çŸ¥è¯†ï¼Œåªéœ€çœ‹å›¾åˆ¤æ–­"

    learner:
      tasks:
        - "ç†è§£æŠ€æœ¯å†³ç­–çš„æƒè¡¡ï¼ˆDecision Rationaleï¼‰"
        - "æ€è€ƒå‡è®¾åœºæ™¯ï¼ˆWhat-If Scenariosï¼‰"
        - "ä»å¤±è´¥ä¸­å­¦ä¹ ï¼ˆFailure Learning Entryï¼‰"
      time_investment: "æ¯ä¸ªåŠŸèƒ½ï¼š20-30åˆ†é’Ÿï¼ˆå¯é€‰ï¼‰"
      skill_acquired: "æŠ€æœ¯å†³ç­–ç›´è§‰ã€ç³»ç»Ÿæ€§æ€ç»´ã€è´¨é‡æ„è¯†"

  participation_points:
    gate1_requirements:
      when: "éœ€æ±‚ç¡®è®¤å®Œæˆ"
      human_action: "ç¡®è®¤éœ€æ±‚ç†è§£æ­£ç¡®"
      evidence_to_review: "éœ€æ±‚æ–‡æ¡£"
      decision: "æ‰¹å‡†è¿›å…¥è®¾è®¡/è¦æ±‚ä¿®æ”¹"
      time_budget: "0åˆ†é’Ÿï¼ˆåŸæœ‰æµç¨‹ï¼‰"

    gate2_design:
      when: "è®¾è®¡å®Œæˆï¼Œåˆ›å»ºhandoffå‰"
      human_action: "å®¡æŸ¥è®¾è®¡è¯æ®"
      evidence_to_review:
        - "å¼ºåˆ¶é—®é¢˜ï¼ˆMQ1-5ï¼‰çš„å›ç­”+è¯æ®"
        - "æ•°æ®æµå›¾å’Œå¯¹ç…§è¡¨"
        - "çŠ¶æ€æµå›¾"
        - "å‡½æ•°ä½ç½®è¯æ˜è¡¨"
      questions_to_answer:
        - "è¯æ®å®Œæ•´å—ï¼Ÿæœ‰æ²¡æœ‰ç©ºç€çš„ï¼Ÿ"
        - "æ•°æ®æµå›¾æ˜¾ç¤ºåç«¯å­—æ®µéƒ½ä¼ åˆ°å‰ç«¯äº†å—ï¼Ÿ"
        - "çŠ¶æ€æµå›¾æ˜¾ç¤ºæ•°æ®åªå­˜ä¸€ä¸ªåœ°æ–¹ï¼Œæˆ–åŒæ­¥æœºåˆ¶æ¸…æ™°å—ï¼Ÿ"
        - "æ–¹å‘çœ‹èµ·æ¥æ­£ç¡®å—ï¼Ÿ"
      decision: "é€šè¿‡â†’ç»§ç»­ / ä¸é€šè¿‡â†’Alexè¡¥å……è¯æ®"
      time_budget: "10-15åˆ†é’Ÿ"

    phase_checkpoints:
      when: "Blakeå®Œæˆæ¯ä¸ªPhase"
      human_action: "å¿«é€Ÿå®¡æŸ¥Phaseäº¤ä»˜ç‰©"
      evidence_to_review:
        - "ä»£ç æˆªå›¾ï¼ˆå…³é”®å‡½æ•°ï¼‰"
        - "æµ‹è¯•ç»“æœæˆªå›¾"
        - "UIæˆªå›¾ï¼ˆå¦‚æœæœ‰UIï¼‰"
      questions_to_answer:
        - "è¿™æ˜¯æˆ‘æœŸæœ›çš„æ–¹å‘å—ï¼Ÿ"
        - "æµ‹è¯•é€šè¿‡äº†å—ï¼Ÿ"
        - "UIæ˜¾ç¤ºæ­£ç¡®å—ï¼Ÿ"
      decision: "ç»§ç»­â†’ä¸‹ä¸ªPhase / è°ƒæ•´â†’ä¿®æ”¹æœ¬Phase"
      time_budget: "5-10åˆ†é’Ÿ/Phase"

    gate3_implementation:
      when: "æ‰€æœ‰Phaseå®Œæˆ"
      human_action: "æœ€ç»ˆéªŒè¯"
      evidence_to_review:
        - "å®Œæ•´çš„æµ‹è¯•æŠ¥å‘Š"
        - "å®Œæ•´çš„UIæˆªå›¾"
        - "æ€§èƒ½æµ‹è¯•ç»“æœï¼ˆå¦‚éœ€è¦ï¼‰"
      decision: "é€šè¿‡â†’äº¤ä»˜ / é—®é¢˜â†’ä¿®å¤"
      time_budget: "10-15åˆ†é’Ÿ"

  total_time_investment:
    per_feature:
      gate2: "10-15åˆ†é’Ÿ"
      phase_checkpoints: "5-10åˆ†é’Ÿ Ã— Phaseæ•°é‡"
      gate3: "10-15åˆ†é’Ÿ"
      learning_optional: "20-30åˆ†é’Ÿ"
      total_example: "å°åŠŸèƒ½çº¦30åˆ†é’Ÿï¼Œä¸­åŠŸèƒ½çº¦60åˆ†é’Ÿï¼Œå¤§åŠŸèƒ½çº¦90åˆ†é’Ÿ"

    value_proposition: |
      æŠ•å…¥30-60åˆ†é’Ÿçš„å®¡æŸ¥+å­¦ä¹ ï¼Œå¯ä»¥ï¼š
      - æå‰å‘ç°æ–¹å‘é”™è¯¯ï¼ˆèŠ‚çœ3-6å°æ—¶è¿”å·¥ï¼‰
      - å‡å°‘æœ€åé˜¶æ®µçš„å¤§é‡ä¿®æ”¹
      - ç¡®ä¿å®ç°ç¬¦åˆçœŸæ­£æ„å›¾ï¼Œä¸æ˜¯å­—é¢æ„æ€
      - å»ºç«‹æŠ€æœ¯å†³ç­–ç›´è§‰ï¼Œé•¿æœŸå—ç›Š

# ==================== å­¦ä¹ æœºåˆ¶ç³»ç»Ÿ ====================
learning_mechanisms:
  enabled: true
  description: "TADä¸ä»…å¸®åŠ©Humanæ‰§è¡Œé¡¹ç›®ï¼Œæ›´å¸®åŠ©Humanå»ºç«‹ç³»ç»Ÿæ€§æ€ç»´å’Œå†³ç­–ç›´è§‰"

  philosophy: |
    ä¼ ç»ŸåŸ¹è®­ï¼šè¯»ä¹¦ â†’ ç†è§£æ¦‚å¿µ â†’ åº”ç”¨ï¼ˆæ–­å±‚ï¼‰
    TADå­¦ä¹ ï¼šçœŸå®å†³ç­– â†’ çœ‹åˆ°åæœ â†’ å»ºç«‹ç›´è§‰ â†’ è‡ªç„¶åº”ç”¨

  learning_dimensions:
    dimension1_technical_tradeoffs:
      name: "æŠ€æœ¯å†³ç­–æƒè¡¡æ€ç»´"
      goal: "å»ºç«‹'æ²¡æœ‰å®Œç¾æ–¹æ¡ˆï¼Œåªæœ‰æƒè¡¡'çš„æ€ç»´"
      levels:
        - "Level 1: çŸ¥é“æœ‰å¤šä¸ªæ–¹æ¡ˆå¯é€‰"
        - "Level 2: ç†è§£æ¯ä¸ªæ–¹æ¡ˆçš„ä¼˜ç¼ºç‚¹"
        - "Level 3: èƒ½åˆ¤æ–­åœ¨å½“å‰åœºæ™¯ä¸‹å“ªä¸ªæ›´åˆé€‚"
        - "Level 4: èƒ½é¢„è§æœªæ¥åœºæ™¯å˜åŒ–æ—¶éœ€è¦åˆ‡æ¢æ–¹æ¡ˆ"
      mechanisms: ["Decision Rationale", "Interactive Challenge"]

    dimension2_systemic_thinking:
      name: "ç³»ç»Ÿæ€§æ€ç»´"
      goal: "çœ‹åˆ°'å±€éƒ¨æ”¹åŠ¨'å¦‚ä½•å½±å“'æ•´ä¸ªç³»ç»Ÿ'"
      levels:
        - "Level 1: çŸ¥é“'æ”¹Aä¼šå½±å“B'"
        - "Level 2: èƒ½ç”»å‡ºå½±å“é“¾è·¯ï¼ˆA â†’ B â†’ Cï¼‰"
        - "Level 3: èƒ½é¢„è§ç¬¬äºŒå±‚å½±å“"
        - "Level 4: èƒ½è®¾è®¡'æ”¹Aä½†ä¸å½±å“B'çš„éš”ç¦»æœºåˆ¶"
      mechanisms: ["Impact Visualization", "What-If Scenarios"]

    dimension3_product_ux:
      name: "äº§å“/UXç›´è§‰"
      goal: "ç†è§£'ç”¨æˆ·çœ‹åˆ°ä»€ä¹ˆ'å’Œ'ç”¨æˆ·æ„Ÿå—åˆ°ä»€ä¹ˆ'"
      levels:
        - "Level 1: çŸ¥é“UIè¦å¥½çœ‹"
        - "Level 2: ç†è§£ä¸åŒè§†è§‰è®¾è®¡ä¼ è¾¾ä¸åŒä¿¡æ¯"
        - "Level 3: èƒ½åˆ¤æ–­å“ªä¸ªè®¾è®¡æ›´ç¬¦åˆç”¨æˆ·ä»»åŠ¡"
        - "Level 4: èƒ½ä»ç”¨æˆ·è¡Œä¸ºæ•°æ®æ¨æ–­UIé—®é¢˜"
      mechanisms: ["What-If Scenarios", "Decision Rationale"]

    dimension4_quality_awareness:
      name: "è´¨é‡æ„è¯†å’Œé£é™©é¢„è§"
      goal: "ç†è§£'ä»€ä¹ˆåœ°æ–¹å®¹æ˜“å‡ºé”™'å’Œ'å¦‚ä½•æå‰é˜²å¾¡'"
      levels:
        - "Level 1: çŸ¥é“è¦æµ‹è¯•"
        - "Level 2: çŸ¥é“æµ‹è¯•ä»€ä¹ˆï¼ˆè¾¹ç•Œæƒ…å†µã€é”™è¯¯è·¯å¾„ï¼‰"
        - "Level 3: èƒ½é¢„è§'æ”¹è¿™é‡Œå¯èƒ½å½±å“é‚£é‡Œ'"
        - "Level 4: èƒ½è®¾è®¡'é˜²å¾¡æ€§æ¶æ„'ï¼ˆå‡ºé”™äº†ä¹Ÿä¸ä¼šé›ªå´©ï¼‰"
      mechanisms: ["Failure Learning Entry", "What-If Scenarios"]

  mechanisms:
    mechanism1_decision_rationale:
      name: "Decision Rationaleï¼ˆå†³ç­–ç†ç”±ï¼‰"
      goal: "ç†è§£ä¸ºä»€ä¹ˆé€‰Aä¸é€‰Bï¼Œå»ºç«‹æƒè¡¡æ€ç»´"
      timing: "æ¯ä¸ªé‡è¦æŠ€æœ¯å†³ç­–"
      format: "å¯¹æ¯”è¡¨æ ¼ + æƒè¡¡åˆ†æ + æœªæ¥åˆ‡æ¢æ¡ä»¶"
      time_cost: "+5åˆ†é’Ÿ"
      learning_dimensions: ["æŠ€æœ¯å†³ç­–", "ç³»ç»Ÿæ€ç»´"]

    mechanism2_interactive_challenge:
      name: "Interactive Challengeï¼ˆäº’åŠ¨æŒ‘æˆ˜ï¼‰"
      goal: "è®©Humanä¸»åŠ¨æ€è€ƒï¼Œè€Œéè¢«åŠ¨æ¥å—ç­”æ¡ˆ"
      timing: "å…³é”®å†³ç­–ç‚¹ï¼Œåœ¨Alexç»™å‡ºæ–¹æ¡ˆä¹‹å‰"
      format: "åœºæ™¯æè¿° + å¤‡é€‰æ–¹æ¡ˆ + æ€è€ƒé—®é¢˜ â†’ Alexåˆ†æ"
      time_cost: "+3åˆ†é’Ÿ"
      learning_dimensions: ["æ‰€æœ‰ç»´åº¦"]

    mechanism3_impact_visualization:
      name: "Impact Visualizationï¼ˆå½±å“å¯è§†åŒ–ï¼‰"
      goal: "çœ‹åˆ°æ”¹åŠ¨çš„è¿é”ååº”"
      timing: "æ¶æ„è®¾è®¡æˆ–æ•°æ®æµå˜æ›´"
      format: "å½±å“é“¾è·¯å›¾ï¼ˆMermaidï¼‰+ å½±å“æ¸…å•ï¼ˆ3å±‚ï¼‰"
      time_cost: "+2åˆ†é’Ÿ"
      learning_dimensions: ["ç³»ç»Ÿæ€ç»´"]

    mechanism4_what_if_scenarios:
      name: "What-If Scenariosï¼ˆå‡è®¾åœºæ™¯ï¼‰"
      goal: "é€šè¿‡å¯¹æ¯”ç†è§£ä¸ºä»€ä¹ˆè¿™æ ·åš"
      timing: "æ¯ä¸ªPhaseå®Œæˆ"
      format: "å®é™…æ–¹æ¡ˆ vs æ›¿ä»£æ–¹æ¡ˆçš„æ•ˆæœå¯¹æ¯”"
      time_cost: "+3åˆ†é’Ÿ"
      learning_dimensions: ["æ‰€æœ‰ç»´åº¦"]

    mechanism5_failure_learning:
      name: "Failure Learning Entryï¼ˆå¤±è´¥å­¦ä¹ ï¼‰"
      goal: "æ¯æ¬¡å‡ºé”™éƒ½æ˜¯å­¦ä¹ æœºä¼šï¼Œé¿å…é‡å¤çŠ¯é”™"
      timing: "Humanå‘ç°é—®é¢˜ã€æµ‹è¯•å¤±è´¥ã€ç”¨æˆ·æŠ¥å‘ŠBug"
      format: "æ ¹å› åˆ†æ + æç‚¼åŸåˆ™ + æ›´æ–°æ£€æŸ¥ç‚¹"
      time_cost: "+10åˆ†é’Ÿï¼ˆä½†é¿å…æœªæ¥é‡å¤ï¼‰"
      learning_dimensions: ["è´¨é‡æ„è¯†"]

  learning_metrics:
    short_term:
      participation_rate:
        gate2_review_completion: ">90%"
        interactive_challenge_response: ">80%"

      understanding:
        decision_rationale_understanding: "èƒ½è¯´å‡º2+ä¸ªæƒè¡¡ç»´åº¦"
        gate2_issue_detection: "æ¯ä¸ªåŠŸèƒ½è‡³å°‘å‘ç°1ä¸ªé—®é¢˜"

    mid_term:
      knowledge_reuse:
        checklist_application: "ä¸»åŠ¨ä½¿ç”¨ä¸Šä¸ªé¡¹ç›®çš„æ£€æŸ¥æ¸…å•"
        principle_recall: "èƒ½ä¸¾ä¾‹ä¹‹å‰å­¦åˆ°çš„åŸåˆ™"

      independent_judgment:
        level: "Humanå¼€å§‹åœ¨Alexæå‡ºå‰å°±æœ‰åˆ¤æ–­"

    long_term:
      systemic_thinking:
        impact_chain_length: "èƒ½é¢„è§1å±‚/2å±‚/3å±‚å½±å“"
        failure_pattern_recognition: "èƒ½è¯†åˆ«3+ç§å¤±è´¥æ¨¡å¼"

      quality_awareness:
        edge_case_consideration: "ä¸»åŠ¨æå‡ºè¾¹ç•Œæƒ…å†µ"

  learning_loop_completion:
    signal: |
      é¡¹ç›®1 â†’ å­¦åˆ°"å•ä¸€æ•°æ®æºåŸåˆ™" â†’ æ›´æ–°MQ5
             â†“
      é¡¹ç›®2 â†’ Humanä¸»åŠ¨é—®"æ•°æ®å­˜å‡ ä¸ªåœ°æ–¹ï¼Ÿ"
             â†’ è®¾è®¡æ—¶å°±é¿å…äº†é—®é¢˜ âœ…

# ==================== Sub-Agentå¼ºåˆ¶ä½¿ç”¨ ====================
subagent_enforcement_v13:
  enabled: true
  description: "ä»å»ºè®®å˜æˆå¼ºåˆ¶ï¼Œå¸¦è¯æ®éªŒè¯"

  agent_a_mandatory:
    product_expert:
      when: "éœ€æ±‚åˆ†æé˜¶æ®µï¼ˆRound 1åï¼‰"
      must_call: true
      evidence_required: "åœ¨éœ€æ±‚æ–‡æ¡£ä¸­åŒ…å«product-expertçš„åˆ†æç»“æœ"
      evidence_format: "ç”¨æˆ·ç”»åƒã€ç”¨ä¾‹åˆ†æã€ä¸šåŠ¡ä»·å€¼è¯„ä¼°"
      violation_action: "é˜»æ­¢è¿›å…¥è®¾è®¡é˜¶æ®µ"

    backend_architect:
      when: "è®¾è®¡ç³»ç»Ÿæ¶æ„ï¼ˆæ¶‰åŠAPI/æ•°æ®åº“/å¾®æœåŠ¡ç­‰ï¼‰"
      must_call: true
      evidence_required: "åœ¨è®¾è®¡æ–‡æ¡£ä¸­åŒ…å«backend-architectçš„å»ºè®®"
      evidence_format: "æ¶æ„å›¾ã€æŠ€æœ¯é€‰å‹ã€æ‰©å±•æ€§åˆ†æ"
      violation_action: "é˜»æ­¢åˆ›å»ºhandoff"

    code_reviewer:
      when: "å®¡æŸ¥Blakeçš„å®ç°"
      must_call: true
      evidence_required: "åœ¨å®¡æŸ¥æŠ¥å‘Šä¸­åŒ…å«code-reviewerçš„å‘ç°"
      evidence_format: "ä»£ç è´¨é‡è¯„åˆ†ã€é—®é¢˜åˆ—è¡¨ã€æ”¹è¿›å»ºè®®"
      violation_action: "é˜»æ­¢æ ‡è®°ä¸ºå®Œæˆ"

  agent_b_mandatory:
    parallel_coordinator:
      when: "ä»»åŠ¡åŒ…å«3ä¸ªä»¥ä¸Šç‹¬ç«‹ç»„ä»¶"
      must_call: true
      detection: "è‡ªåŠ¨æ£€æµ‹handoffä¸­çš„Phaseæ•°é‡â‰¥3"
      evidence_required: "åœ¨å®ŒæˆæŠ¥å‘Šä¸­è¯´æ˜å¦‚ä½•ä½¿ç”¨parallel-coordinator"
      evidence_format: "ä»»åŠ¡åˆ†è§£ã€å¹¶è¡Œæ‰§è¡Œè®¡åˆ’ã€åè°ƒæœºåˆ¶"
      violation_action: "è­¦å‘Šå¹¶è¦æ±‚è¯´æ˜ä¸ºä»€ä¹ˆä¸ç”¨"

    bug_hunter:
      when: "å‡ºç°é”™è¯¯æˆ–æµ‹è¯•å¤±è´¥"
      must_call: true
      detection: "è‡ªåŠ¨æ£€æµ‹é”™è¯¯æ—¥å¿—æˆ–æµ‹è¯•å¤±è´¥"
      evidence_required: "åœ¨ä¿®å¤æŠ¥å‘Šä¸­åŒ…å«bug-hunterçš„è¯Šæ–­"
      evidence_format: "æ ¹å› åˆ†æã€ä¿®å¤æ–¹æ¡ˆã€é¢„é˜²æªæ–½"
      violation_action: "é˜»æ­¢æ ‡è®°ä¸ºä¿®å¤å®Œæˆ"

    test_runner:
      when: "å®Œæˆå®ç°"
      must_call: true
      detection: "Phaseå®Œæˆæ—¶"
      evidence_required: "æµ‹è¯•ç»“æœæˆªå›¾æˆ–æŠ¥å‘Š"
      evidence_format: "æµ‹è¯•é€šè¿‡ç‡ã€è¦†ç›–ç‡ã€å¤±è´¥case"
      violation_action: "é˜»æ­¢è¿›å…¥ä¸‹ä¸ªPhase"

  evidence_format:
    subagent_usage_log: |
      ## Sub-Agentä½¿ç”¨è®°å½•

      | Sub-Agent | æ˜¯å¦è°ƒç”¨ | è°ƒç”¨æ—¶æœº | è¾“å‡ºæ‘˜è¦ | è¯æ®é“¾æ¥ |
      |-----------|---------|---------|---------|---------|
      | product-expert | âœ… | Round 1å | è¯†åˆ«äº†3ä¸ªå…³é”®ç”¨ä¾‹ | [é“¾æ¥åˆ°åˆ†ææ–‡æ¡£] |
      | backend-architect | âœ… | è®¾è®¡é˜¶æ®µ | å»ºè®®ä½¿ç”¨Two-phaseæ¶æ„ | [é“¾æ¥åˆ°æ¶æ„å›¾] |
      | parallel-coordinator | âŒ | N/A | ä»»åŠ¡åªæœ‰2ä¸ªç»„ä»¶ï¼Œä¸éœ€è¦ | N/A |

  human_verification:
    what_to_check: "Sub-Agentä½¿ç”¨è®°å½•è¡¨æ˜¯å¦å®Œæ•´"
    red_flags:
      - "åº”è¯¥è°ƒç”¨ä½†æ ‡è®°ä¸º'âŒ'ä¸”æ— åˆç†åŸå› "
      - "è°ƒç”¨äº†ä½†'è¾“å‡ºæ‘˜è¦'ä¸ºç©º"
      - "'è¯æ®é“¾æ¥'éƒ½æ˜¯N/A"

# ==================== æ—¶é—´ä¼°ç®—æ”¹è¿› ====================
time_estimation_v13:
  principle: "ä¼°ç®—å®ç°æ—¶é—´ Ã— 2 = å®é™…é¢„ç®—æ—¶é—´"
  reason: "è€ƒè™‘å®¡æŸ¥ã€è¿­ä»£ã€æ„å¤–é—®é¢˜ã€æ–‡æ¡£"

  buffer_allocation:
    implementation: 0.40  # çº¯ç¼–ç æ—¶é—´
    review_iteration: 0.30  # Humanå®¡æŸ¥å’Œè¿”å·¥
    unexpected_issues: 0.20  # æ„å¤–é—®é¢˜å¤„ç†
    documentation: 0.10  # æ–‡æ¡£å’ŒæŠ¥å‘Š

  checkpoint_timing:
    rule: "åœ¨50%ä¼°ç®—æ—¶é—´æ—¶ï¼Œå¼ºåˆ¶Humanå®¡æŸ¥"
    purpose: "åŠæ—©å‘ç°æ–¹å‘åå·®ï¼Œé¿å…å…¨éƒ¨è¿”å·¥"
    example: |
      ä¼°ç®—ï¼š8å°æ—¶
      å®é™…é¢„ç®—ï¼š16å°æ—¶
      å¼ºåˆ¶æ£€æŸ¥ç‚¹ï¼š4å°æ—¶å’Œ12å°æ—¶

      åœ¨4å°æ—¶æ—¶ï¼š
      - Blakeå±•ç¤ºå·²å®Œæˆçš„éƒ¨åˆ†
      - Humanç¡®è®¤æ–¹å‘æ­£ç¡®
      - å¦‚æœæ–¹å‘é”™è¯¯ï¼Œåªæµªè´¹äº†4å°æ—¶ï¼Œä¸æ˜¯16å°æ—¶

  tracking:
    record:
      - estimated_time: "ä¼°ç®—æ—¶é—´"
      - actual_time: "å®é™…èŠ±è´¹"
      - deviation_reason: "åå·®åŸå› åˆ†ç±»"
    improve:
      - "åˆ†æåå·®åŸå› "
      - "è°ƒæ•´æœªæ¥ä¼°ç®—ç³»æ•°"
      - "è¯†åˆ«å¸¸è§å»¶è¯¯å› ç´ "

# ==================== å¤±è´¥å­¦ä¹ é—­ç¯ ====================
failure_learning_loop:
  enabled: true
  description: "æ¯æ¬¡å¤±è´¥è‡ªåŠ¨è½¬åŒ–ä¸ºæœªæ¥çš„æ£€æŸ¥ç‚¹"

  trigger: "Humançº æ­£AIé”™è¯¯ï¼Œæˆ–å‘ç°Bugï¼Œæˆ–æµ‹è¯•å¤±è´¥"

  pipeline_steps:
    step1_capture:
      trigger: "Humanè¯´'ä¸å¯¹'ã€'é”™äº†'ã€'è¿™ä¸ªæœ‰é—®é¢˜'"
      action: "åˆ›å»ºFailure Learning Entry"
      data_to_capture:
        - error_type: "æŠ€æœ¯é—®é¢˜ç±»å‹"
        - root_cause: "ä¸ºä»€ä¹ˆå‘ç”Ÿ"
        - should_be_caught_by: "åº”è¯¥ç”±å“ªä¸ªGate/MQæ‹¦æˆª"
        - actual_outcome: "å®é™…ä¸Šæ”¾è¡Œäº†"
        - user_impact: "ç»™ç”¨æˆ·é€ æˆçš„å½±å“"
      output_file: ".tad/evidence/failures/[timestamp]_failure.yaml"

    step2_analyze:
      action: "åˆ†æåº”è¯¥å¢åŠ ä»€ä¹ˆæ£€æŸ¥ç‚¹"
      analysis_questions:
        - "è¿™ä¸ªé—®é¢˜å±äºå“ªä¸ªé˜¶æ®µï¼Ÿï¼ˆéœ€æ±‚/è®¾è®¡/å®ç°ï¼‰"
        - "ç°æœ‰çš„MQèƒ½æ‹¦æˆªå—ï¼Ÿå¦‚æœä¸èƒ½ï¼Œä¸ºä»€ä¹ˆï¼Ÿ"
        - "éœ€è¦ä»€ä¹ˆè¯æ®æ‰èƒ½æå‰å‘ç°ï¼Ÿ"
        - "Humanéœ€è¦çœ‹ä»€ä¹ˆæ‰èƒ½åˆ¤æ–­ï¼Ÿ"
      output_file: ".tad/evidence/failures/[timestamp]_analysis.yaml"

    step3_propose:
      action: "ç”Ÿæˆé…ç½®æ›´æ–°å»ºè®®"
      proposal_content:
        new_mq:
          id: "MQ[X]"
          question: "[ç”Ÿæˆçš„é—®é¢˜]"
          required_evidence: "[è¯æ®ç±»å‹]"
          human_validation_point: "[Humançœ‹ä»€ä¹ˆ]"
        or_mq_update:
          existing_mq: "MQ[Y]"
          enhancement: "[å¦‚ä½•å¢å¼º]"
          new_trigger: "[æ›´å‡†ç¡®çš„è§¦å‘æ¡ä»¶]"
      output_file: ".tad/evidence/failures/[timestamp]_proposal.yaml"

    step4_review:
      action: "Humanå®¡æ ¸ææ¡ˆ"
      human_questions:
        - "è¿™ä¸ªæ–°æ£€æŸ¥ç‚¹åˆç†å—ï¼Ÿ"
        - "ä¼šä¸ä¼šäº§ç”Ÿå¤ªå¤šè¯¯æŠ¥ï¼Ÿ"
        - "æˆ‘èƒ½çœ‹æ‡‚è¿™ä¸ªè¯æ®å—ï¼Ÿ"
      decision:
        approve: "è‡ªåŠ¨æ›´æ–°config.yaml"
        reject: "è®°å½•åŸå› ï¼Œä¸æ›´æ–°"
        modify: "Humanä¿®æ”¹åæ›´æ–°"

    step5_implement:
      action: "è‡ªåŠ¨æ›´æ–°é…ç½®æ–‡ä»¶"
      files_to_update:
        - ".tad/config.yaml"  # æ·»åŠ /æ›´æ–°MQ
        - ".tad/templates/handoff-a-to-b.md"  # æ›´æ–°æ¨¡æ¿
        - ".tad/evidence/patterns/failure-patterns.md"  # æ›´æ–°è®°å½•
      notification: "é…ç½®å·²è‡ªåŠ¨æ›´æ–°ï¼Œä¸‹ä¸ªé¡¹ç›®ç”Ÿæ•ˆ"
      changelog: "è®°å½•åœ¨.tad/CHANGELOG.md"

  metrics_tracking:
    track:
      - "failure_count": "æ€»å¤±è´¥æ¬¡æ•°"
      - "failures_prevented": "æ–°MQæ‹¦æˆªçš„å¤±è´¥"
      - "false_positive_rate": "è¯¯æŠ¥ç‡"
      - "mq_effectiveness": "æ¯ä¸ªMQçš„æœ‰æ•ˆæ€§"
    report_location: ".tad/evidence/metrics/learning-effectiveness.md"

# ==================== é…ç½®ç”Ÿæ•ˆæ—¶é—´ ====================
rollout_plan:
  phase1_immediate:
    description: "å¯ä»¥ç«‹å³å¯ç”¨çš„å¢å¼º"
    items:
      - "mandatory_questions"
      - "evidence_based_verification"
      - "human_role_v13"
    risk: "ä½"
    time: "1-2å¤©"

  phase2_gradual:
    description: "éœ€è¦é€æ­¥æ¨è¿›çš„å¢å¼º"
    items:
      - "progressive_validation"
      - "learning_mechanisms"
      - "subagent_enforcement_v13"
    risk: "ä¸­"
    time: "1-2å‘¨"

  phase3_advanced:
    description: "éœ€è¦å·¥å…·æ”¯æŒçš„å¢å¼º"
    items:
      - "failure_learning_loop"
      - "time_estimation_v13"
    risk: "ä½ï¼ˆå¯é€‰ï¼‰"
    time: "1ä¸ªæœˆ"

# ==================== ç‰ˆæœ¬æ§åˆ¶ ====================
version_history:
  v1.3.0:
    date: "2025-11-25"
    changes:
      - "æ–°å¢è¯æ®å¼éªŒè¯ç³»ç»Ÿï¼ˆ5ç§è¯æ®ç±»å‹ï¼‰"
      - "æ–°å¢å¼ºåˆ¶é—®é¢˜ç³»ç»Ÿï¼ˆMQ1-5ï¼‰"
      - "æ–°å¢æ¸è¿›å¼éªŒè¯ï¼ˆPhaseæ£€æŸ¥ç‚¹ï¼‰"
      - "æ–°å¢Humanè§’è‰²å¢å¼ºï¼ˆCheckpoint Validatorï¼‰"
      - "æ–°å¢å­¦ä¹ æœºåˆ¶ç³»ç»Ÿï¼ˆ5ç§æœºåˆ¶ï¼‰"
      - "æ–°å¢å¤±è´¥å­¦ä¹ é—­ç¯"
    based_on: "MenuSnapé¡¹ç›®å®è¯åˆ†æ + ä¸‰ä»½æ ¸å¿ƒæ–‡æ¡£"
    compatibility: "100%å‘åå…¼å®¹v1.2"

  v1.2:
    date: "2024-XX-XX"
    description: "åŸºç¡€TADæ–¹æ³•è®º"

# ==================== å…¼å®¹æ€§è¯´æ˜ ====================
backward_compatibility:
  v12_projects:
    compatibility: "100%å…¼å®¹"
    explanation: "v1.3æ˜¯å¢é‡æ›´æ–°ï¼Œä¸ç ´åv1.2çš„ä»»ä½•åŠŸèƒ½"
    migration: "å¯ä»¥é€‰æ‹©æ€§å¯ç”¨v1.3ç‰¹æ€§"

  rollback_support:
    enabled: true
    method: "æ¢å¤å¤‡ä»½çš„.tad/config.yaml.v1.2"
    data_preservation: "v1.3åˆ›å»ºçš„è¯æ®æ–‡æ¡£ä¿ç•™ï¼Œä¸å½±å“å›æ»š"